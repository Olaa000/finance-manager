generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id       Int     @id @default(autoincrement())
  name     String
  email    String  @unique
  password String?
  role     String  @default("user")

  incomes  Income[]
  expenses Expense[]
  stats    Stats[]
}

model Income {
  id         Int              @id @default(autoincrement())
  amount     Float
  date       DateTime         @default(now())
  user       User             @relation(fields: [userId], references: [id])
  userId     Int
  categories IncomeCategory[]
}

model Expense {
  id         Int               @id @default(autoincrement())
  amount     Float
  date       DateTime          @default(now())
  user       User              @relation(fields: [userId], references: [id])
  userId     Int
  categories ExpenseCategory[]
}

model Category {
  id       Int               @id @default(autoincrement())
  name     String
  incomes  IncomeCategory[]
  expenses ExpenseCategory[]
}

model Stats {
  id           Int   @id @default(autoincrement())
  totalIncome  Float @default(0)
  totalExpense Float @default(0)
  user         User  @relation(fields: [userId], references: [id])
  userId       Int
}

model IncomeCategory {
  id         Int      @id @default(autoincrement())
  income     Income   @relation(fields: [incomeId], references: [id])
  incomeId   Int
  category   Category @relation(fields: [categoryId], references: [id])
  categoryId Int
}

model ExpenseCategory {
  id         Int      @id @default(autoincrement())
  expense    Expense  @relation(fields: [expenseId], references: [id])
  expenseId  Int
  category   Category @relation(fields: [categoryId], references: [id])
  categoryId Int
}
